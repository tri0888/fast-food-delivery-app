# orders.features.test

| ID | Test level | Mô tả test case | Inter-test case Dependence | Quy trình kiểm thử | Kết quả mong đợi | Dữ liệu kiểm thử | Kết quả |
| --- | --- | --- | --- | --- | --- | --- | --- |
| FE-ORD-001 | System | Đặt đơn trả Stripe checkout URL và cập nhật kho/cart | None | 1. Mock Stripe adapter trả URL.<br>2. Seed user có cart + food stock 5.<br>3. Gọi `placeOrderService.placeOrder` với quantity 2.<br>4. Đọc lại order, food, cart. | Response chứa `session_url`; order lưu; stock giảm; cart trống. | `TD-FEAT-CART-USER`, `TD-FEAT-CART-FOOD`, `TD-FEAT-FLOWS-FRONTEND`, `TD-FEAT-ORDERS-ADDRESSES` | PASS |
| FE-ORD-002 | System | Checkout bị chặn khi vượt quá tồn kho | None | 1. Tạo food `stock: 0` và user.<br>2. Gọi `placeOrderService.placeOrder` quantity 1.<br>3. Quan sát promise reject. | Promise reject `AppError`; stripe adapter không bị gọi. | `TD-FEAT-CART-USER`, `TD-FEAT-CART-FOOD` | PASS |
| FE-ORD-003 | System | Verify thành công đánh dấu order đã thanh toán | None | 1. Seed order chưa thanh toán.<br>2. Gọi `verifyOrderService.verifyOrder(orderId, 'true')`.<br>3. Đọc Order từ DB. | Phản hồi `{ success: true, message: 'Paid' }`, field `payment` chuyển true. | `TD-FEAT-PAYMENT-ORDER` | PASS |
| FE-ORD-004 | System | Admin chỉ chấp nhận trạng thái hợp lệ | None | 1. Tạo order trạng thái `Food Processing`.<br>2. Cập nhật `Delivered` lần 1.<br>3. Gọi lại với `INVALID`. | Lần đầu cập nhật thành `Delivered`; lần hai reject `AppError`. | `TD-FEAT-PAYMENT-ORDER` | PASS |
| FE-ORD-005 | System | listOrders trả toàn bộ đơn cho admin | None | 1. Seed 2 đơn với `userId` khác nhau.<br>2. Gọi `listOrdersService.getAllOrders()`.<br>3. Đếm và so sánh amount. | Mảng length 2 với amount `10`, `20`. | `TD-FEAT-PAYMENT-ORDER`, `TD-FEAT-USERS-LIST` | PASS |
| FE-ORD-006 | System | userOrders trả đúng đơn theo userId | None | 1. Seed 2 user mỗi user 1 order.<br>2. Gọi `userOrdersService.getUserOrders(userId)`.<br>3. Gọi thêm với user giả để bắt lỗi. | Mảng trả về 1 đơn thuộc user; user giả ném `AppError`. | `TD-FEAT-USERS-LIST`, `TD-FEAT-PAYMENT-ORDER` | PASS |
